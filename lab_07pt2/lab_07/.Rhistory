arrange(desc(pills_per_person))
arcos_county
#A: Norton City, Virginia received the most pills per person, at about 2628.9340. It had 10,555,170 total pills.
#table one
total_2006 <- arcos %>%
filter(year=="2006") %>%
clean_names()
#table 2
total_2014 <- arcos %>%
filter(year=="2014") %>%
clean_names()
#combine both tables
arcos_combo <- total_2006 %>%
inner_join(total_2014, by="countyfips") %>%
clean_names()
#combine with sidewalk
arcos_combo_sidewalk <- arcos_combo %>%
inner_join(state_crosswalk, by=c("buyer_state_x"="state_abb"))
view(arcos_combo_sidewalk)
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk
group_by(state_name)
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name)
summarise(total_2014 == sum(total_pills[year==2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills[year==2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year==2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year=2014]))
total_2006 == sum(total_pills_x[year=2006]) %>%
mutate(pct_change=(((total_pills_y-total_pills_x)/total_pills_x)*100))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills[year=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year_y=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name)
summarise(total_2014 == sum(total_pills_y[year_y=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year_y=2014]))
arcos <- read_csv("data/arcos.csv") %>%
clean_names()
x2014_county_pop <- read_csv("data/county_population_2014.csv") %>%
clean_names()
x2014_state_pop <- read_csv("data/state_population_2014.csv") %>%
clean_names()
state_crosswalk <- read_csv("data/state_crosswalk.csv") %>%
clean_names()
#county/city receiving most total opioid pills
arcos_county <- arcos %>%
group_by(countyfips,buyer_county,buyer_state) %>%
summarise(
total_pills = sum(total_pills)
) %>%
inner_join(x2014_county_pop, by=c("countyfips"="geoid")) %>%
mutate(pills_per_person = total_pills/total_population_2014) %>%
arrange(desc(pills_per_person))
arcos_county
#A: Norton City, Virginia received the most pills per person, at about 2628.9340. It had 10,555,170 total pills.
#table one
total_2006 <- arcos %>%
filter(year=="2006") %>%
clean_names()
#table 2
total_2014 <- arcos %>%
filter(year=="2014") %>%
clean_names()
#combine both tables
arcos_combo <- total_2006 %>%
inner_join(total_2014, by="countyfips") %>%
clean_names()
#combine with sidewalk
arcos_combo_sidewalk <- arcos_combo %>%
inner_join(state_crosswalk, by=c("buyer_state_x"="state_abb"))
view(arcos_combo_sidewalk)
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year_y=2014]))
total_2006 == sum(total_pills_x[year_x=2006])
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year_y=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(#total_2014 == sum(total_pills_y[year_y=2014]))
total_2006 == sum(total_pills_x[year_x=2006])
#mutate(pct_change=(((total_2014-total_2006)/total_2006)*100))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2006 == sum(total_pills_x[year_x=2006]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year_y=2014],)
total_2006 == sum(total_pills_x[year_x=2006]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year_y=2014])
total_2006 == sum(total_pills_x[year_x=2006]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y[year_y=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills[year_y=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills[year_y=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y[year_y=2014]))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 == sum(total_pills_y)
total_2006 == sum(total_pills_x))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
print(names(arcos_combo_sidewalk))
arcos <- read_csv("data/arcos.csv") %>%
clean_names()
x2014_county_pop <- read_csv("data/county_population_2014.csv") %>%
clean_names()
x2014_state_pop <- read_csv("data/state_population_2014.csv") %>%
clean_names()
state_crosswalk <- read_csv("data/state_crosswalk.csv") %>%
clean_names()
#county/city receiving most total opioid pills
arcos_county <- arcos %>%
group_by(countyfips,buyer_county,buyer_state) %>%
summarise(
total_pills = sum(total_pills)
) %>%
inner_join(x2014_county_pop, by=c("countyfips"="geoid")) %>%
mutate(pills_per_person = total_pills/total_population_2014) %>%
arrange(desc(pills_per_person))
arcos_county
#A: Norton City, Virginia received the most pills per person, at about 2628.9340. It had 10,555,170 total pills.
#table one
total_2006 <- arcos %>%
filter(year=="2006") %>%
clean_names()
#table 2
total_2014 <- arcos %>%
filter(year=="2014") %>%
clean_names()
#combine both tables
arcos_combo <- total_2006 %>%
inner_join(total_2014, by="countyfips") %>%
clean_names()
#combine with sidewalk
arcos_combo_sidewalk <- arcos_combo %>%
inner_join(state_crosswalk, by=c("buyer_state_x"="state_abb"))
view(arcos_combo_sidewalk)
print(names(arcos_combo_sidewalk))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
#mutate(pct_change=(((total_2014-total_2006)/total_2006)*100))
options(scipen=999)
#calculate the percentage change between 2006 and 2014
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x)) %>%
mutate(pct_change=(((total_2014-total_2006)/total_2006)*100))
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
print(names(arcos_combo_sidewalk))
#print(names(arcos_combo_sidewalk))
view(arcos_combo_sidewalk)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
arcos <- read_csv("data/arcos.csv") %>%
clean_names()
x2014_county_pop <- read_csv("data/county_population_2014.csv") %>%
clean_names()
x2014_state_pop <- read_csv("data/state_population_2014.csv") %>%
clean_names()
state_crosswalk <- read_csv("data/state_crosswalk.csv") %>%
clean_names()
#county/city receiving most total opioid pills
arcos_county <- arcos %>%
group_by(countyfips,buyer_county,buyer_state) %>%
summarise(
total_pills = sum(total_pills)
) %>%
inner_join(x2014_county_pop, by=c("countyfips"="geoid")) %>%
mutate(pills_per_person = total_pills/total_population_2014) %>%
arrange(desc(pills_per_person))
arcos_county
#A: Norton City, Virginia received the most pills per person, at about 2628.9340. It had 10,555,170 total pills.
#table one
total_2006 <- arcos %>%
filter(year=="2006") %>%
clean_names()
#table 2
total_2014 <- arcos %>%
filter(year=="2014") %>%
clean_names()
#combine both tables
arcos_combo <- total_2006 %>%
inner_join(total_2014, by="countyfips") %>%
clean_names()
#combine with sidewalk
arcos_combo_sidewalk <- arcos_combo %>%
inner_join(state_crosswalk, by=c("buyer_state_x"="state_abb"))
view(arcos_combo_sidewalk)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
view(arcos_combo_sidewalk_w_totals)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name,total_pills_x,total_pills_y, everything())
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
arcos <- read_csv("data/arcos.csv") %>%
clean_names()
x2014_county_pop <- read_csv("data/county_population_2014.csv") %>%
clean_names()
x2014_state_pop <- read_csv("data/state_population_2014.csv") %>%
clean_names()
state_crosswalk <- read_csv("data/state_crosswalk.csv") %>%
clean_names()
#county/city receiving most total opioid pills
arcos_county <- arcos %>%
group_by(countyfips,buyer_county,buyer_state) %>%
summarise(
total_pills = sum(total_pills)
) %>%
inner_join(x2014_county_pop, by=c("countyfips"="geoid")) %>%
mutate(pills_per_person = total_pills/total_population_2014) %>%
arrange(desc(pills_per_person))
arcos_county
#A: Norton City, Virginia received the most pills per person, at about 2628.9340. It had 10,555,170 total pills.
#table one
total_2006 <- arcos %>%
filter(year=="2006") %>%
clean_names()
#table 2
total_2014 <- arcos %>%
filter(year=="2014") %>%
clean_names()
#combine both tables
arcos_combo <- total_2006 %>%
inner_join(total_2014, by="countyfips") %>%
clean_names()
#combine with sidewalk
arcos_combo_sidewalk <- arcos_combo %>%
inner_join(state_crosswalk, by=c("buyer_state_x"="state_abb"))
view(arcos_combo_sidewalk)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name,total_pills_x,total_pills_y, everything())
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name,total_pills_x,total_pills_y)
mutate(total_pills_2006 =
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x)))
print(names(arcos_combo_sidewalk))
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name,total_pills_x,total_pills_y)
mutate(total_pills_2006 =
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x)))
#join totals sidewalk w/ regular arcos -- note: I cannot figure out how to make a group by without removing the per state things
arcos_combo_sidewalk2 <- arcos_combo_sidewalk_w_totals %>%
inner_join(arcos_combo_sidewalk, by=c(state_name))
#join totals sidewalk w/ regular arcos -- note: I cannot figure out how to make a group by without removing the per state things
arcos_combo_sidewalk2 <- arcos_combo_sidewalk_w_totals %>%
inner_join(arcos_combo_sidewalk, by=c("state_name"))
#join totals sidewalk w/ regular arcos -- note: I cannot figure out how to make a group by without removing the per state things
arcos_combo_sidewalk2 <- arcos_combo_sidewalk_w_totals %>%
inner_join(arcos_combo_sidewalk, by=c("state_name"))
view(arcos_combo_sidewalk2)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name, total_pills_x, total_pills_y, everything()) %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
view(arcos_combo_sidewalk_w_totals)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name, total_pills_x, total_pills_y, everything()) %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
view(arcos_combo_sidewalk_w_totals)
print(names(arcos_combo_sidewalk_w_totals))
arcos <- read_csv("data/arcos.csv") %>%
clean_names()
x2014_county_pop <- read_csv("data/county_population_2014.csv") %>%
clean_names()
x2014_state_pop <- read_csv("data/state_population_2014.csv") %>%
clean_names()
state_crosswalk <- read_csv("data/state_crosswalk.csv") %>%
clean_names()
#county/city receiving most total opioid pills
arcos_county <- arcos %>%
group_by(countyfips,buyer_county,buyer_state) %>%
summarise(
total_pills = sum(total_pills)
) %>%
inner_join(x2014_county_pop, by=c("countyfips"="geoid")) %>%
mutate(pills_per_person = total_pills/total_population_2014) %>%
arrange(desc(pills_per_person))
arcos_county
#A: Norton City, Virginia received the most pills per person, at about 2628.9340. It had 10,555,170 total pills.
#table one
total_2006 <- arcos %>%
filter(year=="2006") %>%
clean_names()
#table 2
total_2014 <- arcos %>%
filter(year=="2014") %>%
clean_names()
#combine both tables
arcos_combo <- total_2006 %>%
inner_join(total_2014, by="countyfips") %>%
clean_names()
#combine with sidewalk
arcos_combo_sidewalk <- arcos_combo %>%
inner_join(state_crosswalk, by=c("buyer_state_x"="state_abb"))
view(arcos_combo_sidewalk)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name, total_pills_x, total_pills_y, everything()) %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
view(arcos_combo_sidewalk_w_totals)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name, total_pills_x, total_pills_y, everything()) %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
print(arcos_combo_sidewalk_w_totals)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name, total_pills_x, total_pills_y) %>%
group_by(state_name) %>%
summarise(total_2014 = sum(total_pills_y),
total_2006 = sum(total_pills_x))
print(arcos_combo_sidewalk_w_totals)
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name, total_pills_x, total_pills_y) %>%
mutate(total_2014 = sum(total_pills_y))
print(arcos_combo_sidewalk_w_totals)
options(scipen=999)
#create totals of the 2006 and 2014 pills
arcos_combo_sidewalk_w_totals <- arcos_combo_sidewalk %>%
select(state_name, total_pills_x, total_pills_y) %>%
mutate(total_2014 = sum(total_pills_y)) %>%
mutate(total_2006 = sum(total_pills_x))
#group_by(state_name) %>%
#summarise(total_2014 = sum(total_pills_y),
#         total_2006 = sum(total_pills_x))
print(arcos_combo_sidewalk_w_totals)
print(names(arcos_combo_sidewalk_w_totals))
#calculate percent change
arcos_combo_sidewalk_w_totals %>%
mutate(pct_change = (total_2006-total_2014)/total_2006*100) %>%
print(arcos_combo_sidewalk_w_totals)
#calculate percent change
arcos_combo_sidewalk_w_totals %>%
mutate(pct_change = (total_pills_x-total_pills_y)/total_pills_x*100) %>%
print(arcos_combo_sidewalk_w_totals)
#calculate percent change
arcos_combo_sidewalk_w_totals %>%
mutate(pct_change = (total_pills_x-total_pills_y)/total_pills_y*100) %>%
print(arcos_combo_sidewalk_w_totals)
#calculate percent change
arcos_combo_sidewalk_w_totals %>%
mutate(pct_change = (total_pills_y-total_pills_x)/total_pills_x*100) %>%
print(arcos_combo_sidewalk_w_totals)
#make a minimum table
arcos_combo_sidewalk_w_totals %>%
select(state_name,total_pills_x,total_pills_y,pct_change) %>%
slice_min(pct_change, n=5)
#make a minimum table
arcos_combo_sidewalk_w_totals %>%
slice_min(pct_change, n=5)
#make a minimum table
arcos_combo_sidewalk_w_totals %>%
arrange(desc(pct_change))
#calculate percent change
arcos_combo_sidewalk_w_totals %>%
mutate(pct_change == (total_pills_y-total_pills_x)/total_pills_x*100) %>%
print(arcos_combo_sidewalk_w_totals)
#calculate percent change
arcos_combo_sidewalk_w_totals %>%
mutate(pct_change = (total_pills_y-total_pills_x)/total_pills_x*100) %>%
print(arcos_combo_sidewalk_w_totals)
#calculate percent change
arcos_combo_sidewalk_w_totals2 <- arcos_combo_sidewalk_w_totals %>%
mutate(pct_change = (total_pills_y-total_pills_x)/total_pills_x*100) %>%
print(arcos_combo_sidewalk_w_totals)
#make a minimum table
arcos_combo_sidewalk_w_totals2 %>%
arrange(desc(pct_change))
#make a maximum table
arcos_combo_sidewalk_w_totals2 %>%
slice_max(pct_change)
#make a maximum table
arcos_combo_sidewalk_w_totals2 %>%
slice_max(pct_change, n=5)
arcos_combo_sidewalk_w_totals2 %>%
slice_min(pct_change, n=5)
